
{% extends "base.html" %}

{% block content %}

    <div class="post">
    <div class="post-title">
       <a href="{{ post.key().id() }}">{{post.title}}</a>
    </div>
    <div class="post-body">
        {{post.content.replace('\n', '<br>') | safe}}
    </div>
    <span>Post author: {{ post.owner.name }}</span>

    <h3>Leave a comment</h3>
    <form method="POST" action="{{ post.key().id() }}/comment">
        <textarea name="comment" id="" cols="30" rows="10"></textarea>
        <input type="hidden" value="{{ token }}" name="token">
        <input type="submit">
    </form>
</div>

    {%  for c in comment %}
        <p>{{ c.comment }}</p> <span>{{ c.owner.name }}</span>
        <form method='POST' action="/{{ post.key().id() }}/comment/{{ c.key().id() }}/delete"
              onsubmit="return confirm('Are you sure you want to delete this comment?');">
            <input type="submit" value="X">
            <input type="hidden" name="token" value="{{ token }}">
        </form>
        <button id="edit-comment">Edit comment</button>
        <form method="post" action="/{{ post.key().id() }}/comment/{{ c.key().id() }}/edit"
        id="edit-form" style="display: none">
            <textarea name="comment" id="" cols="30" rows="10">{{ c.comment }}</textarea>
            <input type="submit" id='save-comment' value="Save">
        </form>
    {% endfor %}


    <form method='POST' action="{{ post.key().id()}}/rate">
        <input type="submit" value="&#10084;">
        <input type="hidden" name="token" value="{{ token }}">
    </form>
    {{ likes }}

    <a href="/{{ post.key().id() }}/edit">Edit this post</a>
     <form method='POST' action="/{{ post.key().id()}}/delete" onsubmit="return confirm('Are you sure you want to delete this post?');">
        <input type="submit" value="Delete post">
        <input type="hidden" name="token" value="{{ token }}">
    </form>
    {% if error %}
        <p style="color:red;">{{ error }}</p>
    {% endif %}
{% endblock %}